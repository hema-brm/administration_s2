{% from "@components/macros/content.html.twig" import header %}
{% from "@components/macros/content.html.twig" import paginator %}
{% from "@components/macros/table.html.twig" import default as table %}
{% from "@components/input/macros/index.html.twig" import form_search_macro %}


{% extends '@base/app.html.twig' %}

{% block title %}Expenses index{% endblock %}

{% block body %}
    {% from "@components/macros/content.html.twig" import header, button_macro %}

    {{ header({
        text: 'Listes des dépenses',
    }) }}

    <div class="px-4">
    <div class="flex flex-row justify-between py-2">
            <div class="flex flex-row justify-between py-2">
  

    <div class="flex space-x-2">
        <label for="filterMonth">Mois :</label>
        <select id="filterMonth" name="filterMonth">
            <option value="">Tous</option>
            <option value="1">Janvier</option>
            <!-- ... autres mois ... -->
        </select>

        <label for="filterYear">Année :</label>
        <select id="filterYear" name="filterYear">
            <option value="">Toutes</option>
            <option value="2022">2024</option>
            <!-- ... autres années ... -->
        </select>

        <button onclick="applyFilters()">Filtrer</button>
    </div>
</div>

            <a href="{{ path('app_expenses_new') }}">
                <button class="group rounded p-2 bg-primary-50 text-primary-500 text-sm transition-all ease-in-out hover:bg-primary-500 hover:text-white">
                    <i class="fa-solid fa-plus"></i>
                    <span>Nouvelle liste</span>
                </button>
            </a>
    </div>

    <div class="px-4">
        <table class="w-full border shadow-sm mt-4">
            <thead>
                <tr class="border-b border-gray-200">
                    <th class="p-4 text-left">Produit</th>
                    <th class="p-4 text-left">Quantité</th>
                    <th class="p-4 text-left">Prix unitaire</th>
                    <th class="p-4 text-left">Total</th>
                    <th class="p-4 text-left">Date</th>
                </tr>
            </thead>
            <tbody>
                {% for expense in expenses %}
                    <tr class="border-b hover:bg-gray-50 text-sm">

                        <td class="p-4 text-left">{{ expense.product }}</td>
                        <td class="p-4 text-left">{{ expense.quantity }}</td>
                        <td class="p-4 text-left">{{ expense.price }}</td>
                        <td class="p-4 text-left">{{ expense.total }}</td>
                        <td class="p-4 text-left">{{ expense.date ? expense.date|date('Y-m-d') : '' }}</td>

                        <td class="text-right text-secondary-400">
                        <a href="{{ path('app_expenses_edit', {'id': expense.id}) }}">
                            <i class="fa-solid fa-edit hover:text-warning-500"></i>
                        </a>
                    </td>
                    </tr>
                {% else %}
                    <tr>
                    <td colspan="7">
                        <twig:Alert
                            color="warning"
                            text="Aucune liste de dépenses enregistrée"
                            icon="fa-info-circle"
                        />
                    </td>
                {% endfor %}
            </tbody>
        </table>

    </div>
    </div>

    <script>
    function applyFilters() {
        var selectedMonth = document.getElementById("filterMonth").value;
        var selectedYear = document.getElementById("filterYear").value;

        // Générer l'URL avec les filtres
        var url = "{{ path('app_expenses_index') }}";
        if (selectedMonth) {
            url += "?month=" + selectedMonth;
        }
        if (selectedYear) {
            url += (selectedMonth ? "&" : "?") + "year=" + selectedYear;
        }

        // Rediriger vers l'URL avec les filtres
        window.location.href = url;
    }
</script>

{% endblock %}
